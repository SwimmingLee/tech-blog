# 네트워크

### 네트워크는 택배시스템과 같다

네트워크는 생각보다 택배 시스템이랑 비슷하다. 택배를 보낸다고 생각해보자. 

우선, 택배를 보내기 위해서는 상대방 주소가 필요하다. 네트워크 상에서 데이터를 전송하기 위해선 주소가 필요한데, 이게 바로 IP와 MAC이다. 실제로, IP와 MAC만 알면 어느 지역에 있간에 통신할 수 있다. 그렇다면 이 주소를 통해서 어떻게 데이터를 전송할 수 있을까?



#### WAN과 LAN

천안시 홍길동이 천안시 유비에게 택배를 보낸다고 생각해보자. 같은 천안시 내에 있기 때문에, 이름만 알면 바로 배송할 수 있다(고 생각해보자)

그런데 부산에 있는 친구에게 택배를 보낸다고 해보자. 그러면 여러 물류창고를 거치가면서 배송이 되게 된다. 이때는 정확한 주소 정보가 필요하다. 

이처럼 천안시 내에서 택배를 보내는 것처럼 같은 네트워크에 속하는 것은 LAN(Local Area Network)이라고 한다. 그리고 이름이 바로 MAC 주소이다. 즉, LAN은 하나의 네트워크에서 여러 장치가 맡물려서 MAC으로 통신하는 방법이다. 그리고 천안에서 부산으로 택배를 보내는 것으로 네트워크 상에서 외부로 나가면서 통신하는 것을 WAN(Wide Area Network)라고 한다.  여기서 시가 바로 IP에 해당한다.



> L2 스위치는 LAN에서 서로 통신할 때,
>
> L3 라우터는 WAN으로 외부 네트워크로 나갈 때 필요하다.



#### WAN과 LAN의 차이, 서브넷 마스크

택배 시스템을 예시로 들었지만, 실제 네트워크에서는 WAN과 LAN을 무엇을 기준으로 구분할까? 바로 `서브넷 마스크`를 기준으로 한다. 서브넷 마스크는 IP를 `네트워크 영역`과 `호스트 영역`으로 구분하는 방식이다.  

![image-20200702014504317](C:\Users\Lee\AppData\Roaming\Typora\typora-user-images\image-20200702014504317.png)

> IPv4 주소와 서브넷 마스크를 AND연산해서 나오는 부분이 네트워크 영역, 나머지 부분이 호스트 영역이다. 위 예시에서는 192.168.0.3에서 192.168.0이 네트워크 영역, 3이 호스트 영역이 된다.

IP를 서브넷 마스크와 AND 연산하였을 때, 같은 주소가 나오면 LAN에 속해 있는 것이다. 아니면 WAN인 것이다. 

1990년대 후반부터 인터넷이 지배적인 WAN으로 등극하였고, LAN은 이더넷이 지배하게 되었다. 이제 어떤 방식으로 통신이 이뤄지는지 자세히 살펴보고자 한다. 



### MAC과 IP만 알면 어디든 통신할 수 있다!

내가 생대방의 컴퓨터에게 데이터를 전송하고자 한다. 상대방 MAC이랑 IP 주소가 필요하다. 그런데 IP 주소는 알지는 상대방 MAC 주소는 모른다. IP와 마찬가지로 MAC도 통신을 위한 식별자로 사용되지만 상대방 MAC 주소를 직접적으로 넣어주지 않아도 된다. L2 스위치가 해당 IP와 MAC주소를 매핑하여 가지고 있기 때문이다. 그럼 L2 스위치는 어떻게 IP 주소만으로 MAC주소를 얻어 올 수 있을까? 이를 해결하기 위한 방법이 `ARP 알고리즘`이다. 그리고 IP를 가진 호스트와 통신이 되는지 확인하기 위한 방법으로는 `ICMP`를 활용한다. 

#### ARP 

L2 스위치는 브로드 캐스팅으로 특정 아이피를 가지고 있는 컴퓨터의 MAC 주소를 알려주세요.라는 신호를 보낸다. 응답을 들은 컴퓨터는 자신의 IP가 해당 IP가 아니라면 신호를 무시한다. 

IP가 맞으면 자신의 MAC주소를 L2 스위치에게 보내게 되면 스위치는 두 가지 업무를 수행한다. 

- 포워딩 테이블을 채운다. 각 포트와 맥 주소를 매칭시킨다.
- ARP 테이블을 채운다. 각 MAC주소와 IP를 매칭시킨다.

그러면 ARP 테이블을 보고 바로 해당 MAC 주소를 가진 컴퓨터에게 바로 데이터를 전송해 줄 수 있다. IP를 가진 호스트와 통신이 되는지 확인하기 위해서 WAN을 통해 나가야 할 때도 있다. 그러면 게이트웨이를 통해 외부 네트워크로 나가서 데이터를 전송해야 한다. WAN으로 다른 영역에 있는 컴퓨터에 통신하기 위해서는 디폴트 게이트웨이의 맥 주소를 적게 된다. 

L2는 정말로 MAC 주소만 보면 된다. 그 이상 뜯어볼 필요도 없다. 자기 역할에만 충실하면 된다.



### ICMP(Internet Control Message Protocol)

ICMP: IP를 가진 Host와 통신이 되는지 확인

ex) ping 192.158.33.35



### 네트워크의 전체적인 개요! OSI 7계층

OSI 7계층은 개발자의 이해를 돕기위한 네트워크 통신의 흐름을 추상화한 것이다. 

![image-20200702015502477](C:\Users\Lee\AppData\Roaming\Typora\typora-user-images\image-20200702015502477.png)

OSI 모델의 네트워크 상의 데이터 전송을 추상화하여 분류한 모델이다. 각 계층은 개념적인 하위 수준의 정확한 세부 사항에 의존하지 않고, 다른 링크의 해당 계층(피어)와 직접 통신한다. 즉, 한 계층을 수정한다고 다른 계층에 영향을 주지 않는다. 



#### 간단한 계층 소개

- L5-L7 Application Program set 
  - 응용 프로그램 상에서 통신을 위한 프로토콜, 암호화, 압축 등이 모두 포함
- L4 Transport Layer
  - 두 프로세스 사이의 데이터 스트림의 안전성 보장. 수신측에서 받은 세그먼트의 순서가 잘못되면 이를 재정렬하는 프로토콜에 포함
  - 네트워크 과정에서 손실되거나 손상된 세그먼트를 탐지하고 재전송 요청
  - 송신기가 수신에서 처리할 수 있는 것보다 빠르게 데이터를 전송하지 못하도록 흐름 제어 
- L3 Network Layer
  - 다른 호스트로 이동하는 동안 어떤 경로로 취할 것인지 결정
  - 네트워크 경로는 보통 하나 이상의 정류장을 두며, 경로 상의 컴퓨터가 이 정류장에 해당된다. 
- L2 DataLink Layer
  - 로컬 네트워크의 직접적인 연결을 통해 데이터 흐름 관리
  - 두 개의 인접한 개방 시스템간의 효율적인 통신을 위해 흐름제어, 프레임 동기화, 오류 제어, 순서 제어 기능을 한다. 
  - MAC으로 서로를 찾는다.
- L1 Physical Layer
  - 네트워크 연결이 물리적으로 형성되는 곳



### 어디든 가든건 좋아! 이제는 신뢰성까지 보장받고 싶어! 

TCP



2. 네트워크의 전체 그림! OSI 7 계층

   1. 이더넷과 OSI 7 계층은 엄밀히는 다르다!

      1. OSI 7계층은 개발자 들의 이해를 돕기 위한 개념적인것, 이더넷 공식 문서와는 다르다.

      2. 이더넷은 IEEE 820.3 표준의 일부인 프레임 기반, 혹은 데이터 패킷 기반 네트워킹 기술이다

      3. Ethernet은 전세계 학교, 가정, 사무실에서 가장 많이 활용되는 네트워크 규격입니다. 

         이녀석은 OSI 모델 7계층 중 물리 계층(신호와 배선)과 데이터 링크 계층(MAC 패킷, 프로토콜 형식)에서 그 구성 형식이 정의되죠.

   2. 단간한 계층소개

      1. 응용 프로그램 세트  (응용, 표현, 세션)
      2. 전송계층
         1. TCP, UDP(연결, 비연결 지향)
      3. 네트워크계층
         1. IP로 주소를 찾는다!
      4. 데이터링크 계층
         1. MAC으로 찾는다. 
      5. 물리 계층

3. MAC과 IP면 어디든 통신할 수 있다.

   1. L2 switch
   1. ARP
      2. 포워딩 테이블 
2. L3 Router
   
   1. ICMP: IP를 가진 Host와 통신이 되는지 확인!
   
4. 신뢰성 있는 통신을 하고 싶다. TCP

   1. 왜? 현금거래..
   2. 그렇다면 네트워크 문제들은 어떤 것들이 있나.?
      1. 신호감쇄, 고장 -> 오류
      2. 처리율 차이 -> 흐름
      3. 혼잡하다. 혼잡해 -> 혼잡
   3. TCP 소개! 3-Way 핸드쉐이킹, 4-Way핸드쉐이킹
   4. 흐름제어
      1. stop & wait (ack!!) 
      2.  효율적으로 하고 싶다. 슬라이딩 윈도우
   5. 오류제어
      1. timeout!
      2. ack로 인한 오류제어!
      3. CRC
   6. 혼잡제어
      1. 슬라이딩 윈도우 사이즈르 점점 늘린다!!
      2. MSS

5. IP가 부족해!! IP 긴급 수혈이 필요하다. 공유기

   1. 공유기는 사설IP를 다수의 Host가 공용 IP한개로 나눠 쓰는 것
   2. DHCP
   3. 네크워크 주소 변환(NAT 테이블)

6. 무선으로 가자! Wi-Fi(Wi-Fi 이름 유래)

   1. 무선으로 데이터 송/수신하는데 문제는 무엇이 있을까

      1. 감쇄
      2. 마이크로 그림자
      3. 다중 경로 간섭
      4. 채널 혼잡
      5. 타 무선 기술과의 간섭
      6. 숨겨진 노드 문제

   2.  WI-FI 간략한 개요

      1. WI-FI 채널
      2. 2.4GHZ , 5GHZ

   3. 충돌감지? 충동 회피?

      1. 출돌 회피!
      2. 캐리어 감지 및 숨겨진 노드 문제

   4. wi-FI 연결 원리

      1. 스캔, 인증, 결합 
      2. rsA 알고리즘 

   5. WI-FI 보안

      1. 암호화!
      2. WEP
      3. WPA
      4. WPA-2(그리고 WPS)

      

      

보너스
   1. (보너스) WI-FI 물리적인 통신
      2. (보너스) 이더넷 충돌감지와 회피


